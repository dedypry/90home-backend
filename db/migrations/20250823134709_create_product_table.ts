import type { Knex } from 'knex';

const products = [
  {
    id: 6,
    images: '["product/01JVSD738J0190GP444GZRME9W.png"]',
    cluster: 'Beryl',
    price: 166000000.0,
    type: null,
    blok: null,
    description: null,
    updated_by: 1,
    created_at: '2025-05-21T05:31:12.000Z',
    updated_at: '2025-05-23T00:14:17.000Z',
    attachments: '[]',
    listing_type: 'jual',
    developer_id: 1,
    commission_fee: 4.0,
    ppn: 0.0,
    pph: 0.0,
    type_ads: 'baru',
    bedroom: 0,
    bathroom: 0,
    number_of_floors: 0,
    surface_area: 0.0,
    building_area: 0.0,
    certificate: 'ajb',
    furniture: 'non_furnished',
    listing_title: 'Permata Mutiara Maja - Cluster Beryl',
    public_facilities: '[]',
    type_property: 'house',
    pic_id: 6,
  },
  {
    id: 5,
    images: '["product/01JVSCH5E5KR2SCW9K68QX44NB.jpg"]',
    cluster: 'Montana',
    price: 2595000.0,
    type: null,
    blok: null,
    description: '<p>montan non subsidi</p>',
    updated_by: 1,
    created_at: '2025-05-21T05:19:13.000Z',
    updated_at: '2025-05-23T00:15:00.000Z',
    attachments: '[]',
    listing_type: 'jual',
    developer_id: 1,
    commission_fee: 3.0,
    ppn: 0.0,
    pph: 0.0,
    type_ads: null,
    bedroom: 0,
    bathroom: 0,
    number_of_floors: 0,
    surface_area: 0.0,
    building_area: 0.0,
    certificate: null,
    furniture: null,
    listing_title: 'Permata Mutiara Maja - Cluster Montana',
    public_facilities: '[]',
    type_property: null,
    pic_id: 6,
  },
  {
    id: 4,
    images: '["product/01JVS2X6YWY27DC0W9X0EAZXFY.jpg"]',
    cluster: 'onyx',
    price: 166000000.0,
    type: '27/60',
    blok: null,
    description: '<p>type subsidi</p>',
    updated_by: 1,
    created_at: '2025-05-21T02:31:03.000Z',
    updated_at: '2025-05-23T00:15:28.000Z',
    attachments: '[]',
    listing_type: 'jual',
    developer_id: 1,
    commission_fee: 4.0,
    ppn: 0.0,
    pph: 0.0,
    type_ads: null,
    bedroom: 0,
    bathroom: 0,
    number_of_floors: 0,
    surface_area: 0.0,
    building_area: 0.0,
    certificate: 'ajb',
    furniture: 'non_furnished',
    listing_title: 'Permata Mutiara Maja - Cluster onyx',
    public_facilities: '[]',
    type_property: 'house',
    pic_id: 6,
  },
  {
    id: 7,
    images:
      '["product/01JWTNWKB1DZFWVMC44X99TCJD.jpeg","product/01JWTNWKB4MT51KRBKZDA2WYXY.jpeg","product/01JWTNWKB5NKMGEVENHGS2RFBS.jpeg"]',
    cluster: 'Pecatu',
    price: 385000000.0,
    type: 'all',
    blok: null,
    description: null,
    updated_by: 1,
    created_at: '2025-06-03T03:37:42.000Z',
    updated_at: '2025-06-03T03:37:42.000Z',
    attachments: '[]',
    listing_type: 'jual',
    developer_id: 2,
    commission_fee: 2.5,
    ppn: 0.0,
    pph: 0.0,
    type_ads: 'baru',
    bedroom: null,
    bathroom: null,
    number_of_floors: null,
    surface_area: null,
    building_area: null,
    certificate: 'lainnya',
    furniture: 'non_furnished',
    listing_title: 'Rumah di jual di tangerang',
    public_facilities: '[]',
    type_property: 'house',
    pic_id: 5,
  },
];

const product_variants = [
  {
    id: 5,
    type: 'KANA - A (27/72)',
    blok: 'Standar',
    price: 288045000.0,
    description: '<p>montana type standar</p>',
    created_at: '2025-05-21T05:19:14.000Z',
    updated_at: '2025-05-21T05:19:14.000Z',
    product_id: 5,
    images: '["product/01JVSCH5E9V38XBRTDKVS0KHEA.jpg"]',
    commission_fee: 3.0,
    ppn: 0.0,
    pph: 0.0,
  },
  {
    id: 6,
    type: 'KANA - A (27/72)',
    blok: 'SUDUT',
    price: 292485000.0,
    description: '<p>Kana type sudut</p>',
    created_at: '2025-05-21T05:19:14.000Z',
    updated_at: '2025-05-21T05:19:14.000Z',
    product_id: 5,
    images: '[]',
    commission_fee: 3.0,
    ppn: 0.0,
    pph: 0.0,
  },
  {
    id: 8,
    type: 'KANA -B (27/90)',
    blok: 'STANDAR',
    price: 331335000.0,
    description: null,
    created_at: '2025-05-21T05:24:40.000Z',
    updated_at: '2025-05-21T05:24:40.000Z',
    product_id: 5,
    images: '[]',
    commission_fee: 3.0,
    ppn: 0.0,
    pph: 0.0,
  },
  {
    id: 9,
    type: 'KANA -B (27/90)',
    blok: 'SUDUT',
    price: 336885000.0,
    description: null,
    created_at: '2025-05-21T05:24:40.000Z',
    updated_at: '2025-05-21T05:24:40.000Z',
    product_id: 5,
    images: '[]',
    commission_fee: 3.0,
    ppn: 0.0,
    pph: 0.0,
  },
  {
    id: 11,
    type: 'KANA - C (27/102)',
    blok: 'STANDAR',
    price: 360195000.0,
    description: null,
    created_at: '2025-05-21T05:24:40.000Z',
    updated_at: '2025-05-21T05:24:40.000Z',
    product_id: 5,
    images: '[]',
    commission_fee: 3.0,
    ppn: 0.0,
    pph: 0.0,
  },
  {
    id: 12,
    type: 'KANA - C (27/102)',
    blok: 'SUDUT',
    price: 366522000.0,
    description: null,
    created_at: '2025-05-21T05:24:40.000Z',
    updated_at: '2025-05-21T05:24:40.000Z',
    product_id: 5,
    images: '[]',
    commission_fee: 3.0,
    ppn: 0.0,
    pph: 0.0,
  },
  {
    id: 13,
    type: 'KANA - C (27/102)',
    blok: 'TAMAN',
    price: 372738000.0,
    description: null,
    created_at: '2025-05-21T05:24:40.000Z',
    updated_at: '2025-05-21T05:24:40.000Z',
    product_id: 5,
    images: '[]',
    commission_fee: 3.0,
    ppn: 0.0,
    pph: 0.0,
  },
  {
    id: 14,
    type: 'Lily (27/60)',
    blok: null,
    price: 166000000.0,
    description: null,
    created_at: '2025-05-21T05:31:12.000Z',
    updated_at: '2025-05-21T05:31:12.000Z',
    product_id: 6,
    images: '[]',
    commission_fee: 4.0,
    ppn: 0.0,
    pph: 0.0,
  },
  {
    id: 4,
    type: 'Seruni (27/60)',
    blok: null,
    price: 166000000.0,
    description: '<p>type subsidi</p>',
    created_at: '2025-05-21T02:31:03.000Z',
    updated_at: '2025-05-21T05:40:43.000Z',
    product_id: 4,
    images: '[]',
    commission_fee: 4.0,
    ppn: 0.0,
    pph: 0.0,
  },
  {
    id: 7,
    type: 'KANA - A (27/72)',
    blok: 'TAMAN',
    price: 296925000.0,
    description: null,
    created_at: '2025-05-21T05:19:14.000Z',
    updated_at: '2025-05-21T07:56:27.000Z',
    product_id: 5,
    images: '[]',
    commission_fee: 3.0,
    ppn: 0.0,
    pph: 0.0,
  },
  {
    id: 10,
    type: 'KANA -B (27/90)',
    blok: 'TAMAN',
    price: 342435000.0,
    description: null,
    created_at: '2025-05-21T05:24:40.000Z',
    updated_at: '2025-05-21T07:56:27.000Z',
    product_id: 5,
    images: '[]',
    commission_fee: 3.0,
    ppn: 0.0,
    pph: 0.0,
  },
];

const developers = [
  {
    id: 2,
    company_name: 'Citra Maja City',
    phone: '021999999',
    email: 'citra@gmail.com',
    address_title: null,
    address: '<p>-</p>',
    logo: 'https://gallery.dpn-pppi.org/90-home/vendor_logo/01JWTNH2A1PM7VCV7KS8YJFDZ9.png',
    company_brand: 'Citra Maja City',
  },
  {
    id: 1,
    company_name: 'PERMATA MUTIARA MAJA (PMM)',
    phone: '081213805336',
    email: 'a.zaenuriramdani@gmail.com',
    address_title: null,
    address:
      '<p>Jl. Raya Maja, Maja,</p><p>Kec. Maja, Kabupaten Lebak, Banten</p>',
    logo: 'https://gallery.dpn-pppi.org/90-home/vendor_logo/01JVS00P41N6PMPHGJ4T6KCDMY.png',
    company_brand: 'PT. Bukitnusaindahperkasa',
  },
];
const tableName = 'products';
export async function up(knex: Knex): Promise<void> {
  await knex('developers').insert(developers);

  for (const product of products) {
    await knex(tableName).insert({
      id: product.id,
      images: JSON.parse(product.images).map(
        (img) => `https://gallery.dpn-pppi.org/90-home/${img}`,
      ),
      cluster: product.cluster,
      price: product.price,
      description: product.description,
      commission_fee: product.commission_fee,
      developer_id: product.developer_id,
      type_ads: product.type_ads,
      certificate: product.certificate,
      furniture: product.furniture,
      listing_title: product.listing_title,
      type_property: product.type_property,
    });
    if (product.price && product.type && product.commission_fee) {
      await knex('product_variants').insert({
        price: product.price,
        type: product.type,
        commission_fee: product.commission_fee,
        product_id: product.id,
      });
    }

    const variant = product_variants.filter((e) => e.product_id === product.id);

    if (variant.length > 0) {
      await knex('product_variants').insert(
        variant.map((item) => ({
          id: item.id,
          price: item.price,
          type: `${item.type} ${item.blok ? ' - ' + item.blok : ''}`,
          commission_fee: item.commission_fee,
          product_id: product.id,
        })),
      );
    }
  }
}

export async function down(knex: Knex): Promise<void> {
  await knex.schema.dropTableIfExists(tableName);
}
